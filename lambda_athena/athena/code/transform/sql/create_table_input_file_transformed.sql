CREATE TABLE api_input_{namespace}.input_file_transformed_{instance}
WITH (external_location = '{input-bucket-name}/{path-name}/',
      format = 'PARQUET',
      parquet_compression = 'SNAPPY')
AS 
SELECT
   craftdetails_make                                                ,
   craftdetails_model                                               ,
   craftdetails_ownerorganisation                                   ,
   craftdetails_imoregistryplace_type                               ,
   craftdetails_imonumber                                           ,
   craftdetails_imodate                                             ,
   craftdetails_mmsinumber                                          ,
   craftdetails_callsign                                            ,
   craftdetails_hullcolour                                          ,
   craftdetails_metrelength                                         ,
   craftdetails_portofregistration_type                             ,
   craftdetails_portofregistration_location_iatacode                ,
   craftdetails_portofregistration_location_icaocode                ,
   craftdetails_portofregistration_location_coordinates_latitude    ,
   craftdetails_portofregistration_location_coordinates_longitude   ,
   craftdetails_imoregistryplace_location_iatacode                  ,
   craftdetails_imoregistryplace_location_icaocode                  ,
   craftdetails_imoregistryplace_location_unlocode                  ,
   craftdetails_imoregistryplace_location_coordinates_latitude      ,
   craftdetails_imoregistryplace_location_coordinates_longitude     ,
   craftdetails_imoregistryplace_location_address_addressline       ,
   craftdetails_imoregistryplace_location_address_postcode          ,
   craftdetails_imoregistryplace_location_address_country           ,
   craftdetails_imoregistryplace_location_description               ,
   craftdetails_ownername_firstname                                 ,
   craftdetails_ownername_middlename                                ,
   craftdetails_ownername_surname                                   ,
   craftdetails_registrationcountrycode                             ,
   craftdetails_registrationno                                      ,
   craftdetails_sailmarkings                                        ,
   craftdetails_tonnage                                             ,
   craftdetails_portofregistration_location_unlocode                ,
   craftdetails_transporttype                                       ,
   craftdetails_type                                                ,
   craftdetails_vesselname                                          ,
   craftdetails_yearbuilt                                           ,
   craftdetails_portofregistration_location_address_addressline     ,
   craftdetails_portofregistration_location_address_postcode        ,
   craftdetails_portofregistration_location_address_country         ,
   craftdetails_portofregistration_location_description             ,
   flightdetails_arrivalairport                                     ,
   flightdetails_arrivalairportextended_address_addressline         ,
   flightdetails_arrivalairportextended_address_country             ,
   flightdetails_arrivalairportextended_address_postcode            ,
   flightdetails_arrivalairportextended_coordinates_latitude        ,
   flightdetails_arrivalairportextended_coordinates_longitude       ,
   flightdetails_arrivalairportextended_description                 ,
   flightdetails_arrivalairportextended_iatacode                    ,
   flightdetails_arrivalairportextended_icaocode                    ,
   flightdetails_arrivalairportextended_unlocode                    ,
   flightdetails_arrivaldatetime                                    ,
   flightdetails_arrivaldatetimeutc                                 ,
   flightdetails_cargo                                              ,
   flightdetails_carrier                                            ,
   flightdetails_carriertype                                        ,
   flightdetails_craftid                                            ,
   flightdetails_crewcount                                          ,
   flightdetails_datetimesent                                       ,
   flightdetails_departureairport                                   ,
   flightdetails_departureairportextended_address_addressline       ,
   flightdetails_departureairportextended_address_country           ,
   flightdetails_departureairportextended_address_postcode          ,
   flightdetails_departureairportextended_coordinates_latitude      ,
   flightdetails_departureairportextended_coordinates_longitude     ,
   flightdetails_departureairportextended_description               ,
   flightdetails_departureairportextended_iatacode                  ,
   flightdetails_departureairportextended_icaocode                  ,
   flightdetails_departureairportextended_unlocode                  ,
   flightdetails_departuredatetime                                  ,
   flightdetails_departuredatetimeutc                               ,
   flightdetails_eventcode                                          ,
   flightdetails_exception                                          ,
   flightdetails_flightid                                           ,
   flightdetails_hireorcharter                                      ,
   flightdetails_hireorcharterdetails                               ,
   flightdetails_manifesttype                                       ,
   flightdetails_operatoraddress_addressline                        ,
   flightdetails_operatoraddress_country                            ,
   flightdetails_operatoraddress_postcode                           ,
   flightdetails_operatorname_firstname                             ,
   flightdetails_operatorname_middlename                            ,
   flightdetails_operatorname_surname                               ,
   flightdetails_passengercount                                     ,
   flightdetails_rawflightid                                        ,
   flightdetails_route                                              ,
   flightdetails_subsequentport                                     ,
   flightitinerary_departure_locationnamecode                       ,
   flightitinerary_departure_locationfunctioncode                   ,
   flightitinerary_departuredatetime                                ,
   flightitinerary_departure_locationnameextended_iatacode          ,
   flightitinerary_departure_locationnameextended_icaocode          ,
   flightitinerary_arrival_locationnamecode                         ,
   flightitinerary_arrival_locationfunctioncode                     ,
   flightitinerary_arrivaldatetime                                  ,
   flightitinerary_arrival_locationnameextended_iatacode            ,
   flightitinerary_arrival_locationnameextended_icaocode            ,
   passengerdetails_officeofclearance                               ,
   passengerdetails_passengeridentifier                             ,
   passengerdetails_age                                             ,
   passengerdetails_dateofbirth                                     ,
   passengerdetails_firstname                                       ,
   passengerdetails_secondname                                      ,
   passengerdetails_surname                                         ,
   passengerdetails_gender                                          ,
   passengerdetails_homeaddress_addressline                         ,
   passengerdetails_homeaddress_postcode                            ,
   passengerdetails_homeaddress_country                             ,
   passengerdetails_intransitflag                                   ,
   passengerdetails_nationality                                     ,
   passengerdetails_countryofresidence                              ,
   passengerdetails_country                                         ,
   passengerdetails_postalcode                                      ,
   passengerdetails_rankrating                                      ,
   passengerdetails_placeofbirth                                    ,
   passengerdetails_state                                           ,
   passengerdetails_passengertype                                   ,
   passengerdetails_pnrlocator                                      ,
   passengerdetails_street                                          ,
   passengerdetails_city                                            ,
   passengerdetails_portofdisembarkationextended_iatacode           ,
   passengerdetails_portofdisembarkationextended_icaocode           ,
   passengerdetails_portofdisembarkationextended_unlocode           ,
   passengerdetails_portofdisembarkationextended_coordinates_lati   ,
   passengerdetails_portofdisembarkationextended_coordinates_long   ,
   passengerdetails_portofdisembarkationextended_address_addressl   ,
   passengerdetails_portofdisembarkationextended_address_postcode   ,
   passengerdetails_portofdisembarkationextended_address_country    ,
   passengerdetails_vehicledetails_registrationnumber               ,
   passengerdetails_vehicledetails_vehicletype                      ,
   passengerdetails_vehicledetails_make                             ,
   passengerdetails_vehicledetails_model                            ,
   passengerdetails_vehicledetails_registrationcountry              ,
   passengerdetails_vehicledetails_vin                              ,
   passengerdetails_vehicledetails_year                             ,
   passengerdetails_vehicledetails_colour                           ,
   passengerdetails_portofembark                                    ,
   passengerdetails_portofdisembark                                 ,
   passengerdetails_crewallowance_goodstodeclare                    ,
   passengerdetails_crewallowance_goodsdetail                       ,
   passengerdetails_purposeofvisit                                  ,
   passengerdetails_lengthofstayinuk                                ,
   passengerdetails_visaholder                                      ,
   passengerdetails_contactnumber_phonenumber                       ,
   passengerdetails_contactnumber_phonenumbertype                   ,
   passengerdetails_interactivedetail_passengeridentifier           ,
   passengerdetails_interactivedetail_redressno                     ,
   passengerdetails_interactivedetail_knowntravellerno              ,
   passengerdetails_documentdetails_documenttype                    ,
   passengerdetails_documentdetails_documentno                      ,
   passengerdetails_documentdetails_docissuedate                    ,
   passengerdetails_documentdetails_docexpirationdate               ,
   passengerdetails_documentdetails_countryofissue                  ,
   passengerdetails_documentdetails_cityofissue                     ,
   sendingpartydetails_contactid                                    ,
   sendingpartydetails_contactname                                  ,
   sendingpartydetails_firstcommsaddresscode                        ,
   sendingpartydetails_firstcommsaddressid                          ,
   sendingpartydetails_secondcommsaddresscode                       ,
   sendingpartydetails_secondcommsaddressid                         ,
   dcsdetails_flightsummary_airlinecode                             ,
   dcsdetails_flightsummary_flightarrivalairport                    ,
   dcsdetails_flightsummary_flightarrivaldate                       ,
   dcsdetails_flightsummary_flightarrivaltime                       ,
   dcsdetails_flightsummary_flightcode                              ,
   dcsdetails_flightsummary_flightdepartureairport                  ,
   dcsdetails_flightsummary_flightdeparturedate                     ,
   dcsdetails_flightsummary_flightdeparturetime                     ,
   dcsdetails_flightsummary_rawflightcode                           ,
   dcsdetails_dcsdata_dcsrecord_baggagedetail                       ,
   dcsdetails_dcsdata_dcsrecord_cabinclass                          ,
   dcsdetails_dcsdata_dcsrecord_carryoncount                        ,
   dcsdetails_dcsdata_dcsrecord_checkedincount                      ,
   dcsdetails_dcsdata_dcsrecord_checkedinweight                     ,
   dcsdetails_dcsdata_dcsrecord_checkinagent                        ,
   dcsdetails_dcsdata_dcsrecord_checkindatetime                     ,
   dcsdetails_dcsdata_dcsrecord_checkinlocation                     ,
   dcsdetails_dcsdata_dcsrecord_destination                         ,
   dcsdetails_dcsdata_dcsrecord_firstname                           ,
   dcsdetails_dcsdata_dcsrecord_frequentflyernumber                 ,
   dcsdetails_dcsdata_dcsrecord_passengerseq                        ,
   dcsdetails_dcsdata_dcsrecord_pnrlocator                          ,
   dcsdetails_dcsdata_dcsrecord_pooledto                            ,
   dcsdetails_dcsdata_dcsrecord_seatnumber                          ,
   dcsdetails_dcsdata_dcsrecord_securitynumber                      ,
   dcsdetails_dcsdata_dcsrecord_sequencenumber                      ,
   dcsdetails_dcsdata_dcsrecord_surname                             ,
   dcsdetails_dcsdata_dcsrecord_ticketnumber                        ,
   dcsdetails_dcsdata_dcsrecord_ticketstatus                        ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_traveldocnumber      ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_traveldoctype        ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_traveldoclocofissue  ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_dateofbirth          ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_gender               ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_docissuedate         ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_docexpirationdate    ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_cityofissue          ,
   dcsdetails_dcsdata_dcsrecord_traveldocument_pnrpassengerref      ,
   pnrdetails_accompaniedbyinfant                                   ,
   pnrdetails_bookingdate                                           ,
   pnrdetails_creationdate                                          ,
   pnrdetails_masterpnrlocator                                      ,
   pnrdetails_modifieddate                                          ,
   pnrdetails_pnrlocator                                            ,
   pnrdetails_retrieveddate                                         ,
   pnrdetails_splitpnr                                              ,
   pnrdetails_travelagent                                           ,
   pnrdetails_unaccompaniedminor                                    ,
   sourcedata_component                                             ,
   sourcedata_interactivedata_commonaccessref                       ,
   sourcedata_interactivedata_functionalgrouprefno                  ,
   sourcedata_interactivedata_isinteractive                         ,
   sourcedata_interactivedata_route                                 ,
   sourcedata_interactivedata_senderid                              ,
   sourcedata_interactivedata_variant                               ,
   sourcedata_source                                                ,
   sourcedata_subject                                               ,
   sourcedata_type                                                  ,
   manifestdetails_datetimereceived                                 ,
   manifestdetails_manifestguid                                     ,
   manifestdetails_datatype                                         ,
   manifestdetails_protocol                                         ,
   s3_location                                                      ,
   xml_file_name                                                    ,
   file_name                                                        ,
   extra_rec_type
FROM
	api_input_{namespace}.input_file_{instance};
