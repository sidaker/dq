CREATE EXTERNAL TABLE IF NOT EXISTS internal_storage_table_consolidated
(
    craftDetails_make VARCHAR(100),
    craftDetails_model VARCHAR(100),
    craftDetails_ownerOrganisation VARCHAR(100),
    craftDetails_imoRegistryPlace_type VARCHAR(100),
    craftDetails_imoNumber VARCHAR(100),
    craftDetails_imoDate VARCHAR(100),
    craftDetails_mmsiNumber VARCHAR(100),
    craftDetails_callSign VARCHAR(100),
    craftDetails_hullColour VARCHAR(100),
    craftDetails_metreLength VARCHAR(100),
    craftDetails_portOfRegistration_type VARCHAR(100),
    craftDetails_portOfRegistration_location_iataCode VARCHAR(15),
    craftDetails_portOfRegistration_location_icaoCode VARCHAR(15),
    craftDetails_portOfRegistration_location_coordinates_latitude VARCHAR(15),
    craftDetails_portOfRegistration_location_coordinates_longitude VARCHAR(15),
    craftDetails_imoRegistryPlace_location_iataCode VARCHAR(100),
    craftDetails_imoRegistryPlace_location_icaoCode VARCHAR(100),
    craftDetails_imoRegistryPlace_location_unloCode VARCHAR(100),
    craftDetails_imoRegistryPlace_location_coordinates_latitude VARCHAR(100),
    craftDetails_imoRegistryPlace_location_coordinates_longitude VARCHAR(100),
    craftDetails_imoRegistryPlace_location_address_addressline VARCHAR(100),
    craftDetails_imoRegistryPlace_location_address_postcode VARCHAR(100),
    craftDetails_imoRegistryPlace_location_address_country VARCHAR(100),
    craftDetails_imoRegistryPlace_location_description VARCHAR(500),
    craftDetails_ownerName_firstName VARCHAR(100),
    craftDetails_ownerName_middleName VARCHAR(100),
    craftDetails_ownerName_surname VARCHAR(100),
    craftDetails_registrationCountryCode VARCHAR(100),
    craftDetails_registrationNo VARCHAR(100),
    craftDetails_sailMarkings VARCHAR(100),
    craftDetails_tonnage VARCHAR(100),
    craftDetails_portOfRegistration_location_unloCode VARCHAR(100),
    craftDetails_transportType VARCHAR(200),
    craftDetails_type VARCHAR(100),
    craftDetails_vesselName VARCHAR(100),
    craftDetails_yearBuilt VARCHAR(100),
    craftDetails_portOfRegistration_location_address_addressLine VARCHAR(15),
    craftDetails_portOfRegistration_location_address_postCode VARCHAR(15),
    craftDetails_portOfRegistration_location_address_country VARCHAR(15),
    craftDetails_portOfRegistration_location_description VARCHAR(15),
    flightDetails_arrivalAirport VARCHAR(100),
    flightDetails_arrivalAirportExtended_Address_addressLine VARCHAR(500),
    flightDetails_arrivalAirportExtended_Address_country VARCHAR(30),
    flightDetails_arrivalAirportExtended_Address_postCode VARCHAR(100),
    flightDetails_arrivalAirportExtended_coordinates_latitude VARCHAR(13),
    flightDetails_arrivalAirportExtended_coordinates_longitude VARCHAR(13),
    flightDetails_arrivalAirportExtended_description VARCHAR(500),
    flightDetails_arrivalAirportExtended_iataCode VARCHAR(13),
    flightDetails_arrivalAirportExtended_icaoCode VARCHAR(13),
    flightDetails_arrivalAirportExtended_unloCode VARCHAR(13),
    flightDetails_arrivalDateTime VARCHAR(200),
    flightDetails_arrivalDateTimeUTC VARCHAR(200),
    flightDetails_cargo VARCHAR(100),
    flightDetails_carrier VARCHAR(100),
    flightDetails_carrierType VARCHAR(100),
    flightDetails_craftId VARCHAR(200),
    flightDetails_crewCount VARCHAR(200),
    flightDetails_dateTimeSent VARCHAR(200),
    flightDetails_departureAirport VARCHAR(100),
    flightDetails_departureAirportExtended_Address_addressLine VARCHAR(500),
    flightDetails_departureAirportExtended_Address_country VARCHAR(100),
    flightDetails_departureAirportExtended_Address_postCode VARCHAR(100),
    flightDetails_departureAirportExtended_coordinates_latitude VARCHAR(13),
    flightDetails_departureAirportExtended_coordinates_longitude VARCHAR(13),
    flightDetails_departureAirportExtended_description VARCHAR(500),
    flightDetails_departureAirportExtended_iataCode VARCHAR(13),
    flightDetails_departureAirportExtended_icaoCode VARCHAR(13),
    flightDetails_departureAirportExtended_unloCode VARCHAR(13),
    flightDetails_departureDateTime VARCHAR(200),
    flightDetails_departureDateTimeUTC VARCHAR(200),
    flightDetails_eventCode VARCHAR(200),
    flightDetails_exception VARCHAR(200),
    flightDetails_flightId VARCHAR(100),
    flightDetails_hireOrCharter VARCHAR(200),
    flightDetails_hireOrCharterDetails VARCHAR(500),
    flightDetails_manifestType VARCHAR(100),
    flightDetails_operatorAddress_addressLine VARCHAR(200),
    flightDetails_operatorAddress_country VARCHAR(200),
    flightDetails_operatorAddress_postCode VARCHAR(200),
    flightDetails_operatorName_firstName VARCHAR(200),
    flightDetails_operatorName_middleName VARCHAR(200),
    flightDetails_operatorName_surname VARCHAR(200),
    flightDetails_passengerCount VARCHAR(200),
    flightDetails_rawFlightId VARCHAR(100),
    flightDetails_route VARCHAR(200),
    flightDetails_subsequentPort VARCHAR(200),
    flightItinerary_departure_locationNameCode VARCHAR(100),
    flightItinerary_departure_locationFunctionCode VARCHAR(100),
    flightItinerary_departureDateTime VARCHAR(100),
    flightItinerary_departure_locationNameExtended_iataCode VARCHAR(100),
    flightItinerary_departure_locationNameExtended_icaoCode VARCHAR(100),
    flightItinerary_arrival_locationNameCode VARCHAR(100),
    flightItinerary_arrival_locationFunctionCode VARCHAR(100),
    flightItinerary_arrivalDateTime VARCHAR(100),
    flightItinerary_arrival_locationNameExtended_iataCode VARCHAR(100),
    flightItinerary_arrival_locationNameExtended_icaoCode VARCHAR(100),
    passengerDetails_officeOfClearance VARCHAR(200),
    passengerDetails_passengerIdentifier VARCHAR(200),
    passengerDetails_age VARCHAR(200),
    passengerDetails_dateOfBirth VARCHAR(200),
    passengerDetails_firstName VARCHAR(200),
    passengerDetails_secondName VARCHAR(200),
    passengerDetails_surname VARCHAR(200),
    passengerDetails_gender VARCHAR(200),
    passengerDetails_homeAddress_addressLine VARCHAR(200),
    passengerDetails_homeAddress_postCode VARCHAR(200),
    passengerDetails_homeAddress_country VARCHAR(200),
    passengerDetails_inTransitFlag VARCHAR(200),
    passengerDetails_nationality VARCHAR(200),
    passengerDetails_countryOfResidence VARCHAR(200),
    passengerDetails_country VARCHAR(200),
    passengerDetails_postalCode VARCHAR(200),
    passengerDetails_rankRating VARCHAR(200),
    passengerDetails_placeOfBirth VARCHAR(200),
    passengerDetails_state VARCHAR(200),
    passengerDetails_passengerType VARCHAR(200),
    passengerDetails_pnrLocator VARCHAR(200),
    passengerDetails_street VARCHAR(200),
    passengerDetails_city VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_iataCode VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_icaoCode VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_unloCode VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_coordinates_lati VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_coordinates_long VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_address_addressL VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_address_postcode VARCHAR(200),
    passengerDetails_portOfDisembarkationExtended_address_country VARCHAR(200),
    passengerDetails_vehicleDetails_registrationNumber VARCHAR(200),
    passengerDetails_vehicleDetails_vehicleType VARCHAR(200),
    passengerDetails_vehicleDetails_make VARCHAR(200),
    passengerDetails_vehicleDetails_model VARCHAR(200),
    passengerDetails_vehicleDetails_registrationCountry VARCHAR(200),
    passengerDetails_vehicleDetails_vin VARCHAR(200),
    passengerDetails_vehicleDetails_year VARCHAR(200),
    passengerDetails_vehicleDetails_colour VARCHAR(200),
    passengerDetails_portOfEmbark VARCHAR(200),
    passengerDetails_portOfDisembark VARCHAR(200),
    passengerDetails_crewAllowance_goodsToDeclare VARCHAR(200),
    passengerDetails_crewAllowance_goodsDetail VARCHAR(200),
    passengerDetails_purposeOfVisit VARCHAR(200),
    passengerDetails_lengthOfStayInUK VARCHAR(200),
    passengerDetails_visaHolder VARCHAR(200),
    passengerDetails_contactNumber_phoneNumber VARCHAR(200),
    passengerDetails_contactNumber_phoneNumberType VARCHAR(200),
    passengerDetails_interactiveDetail_passengerIdentifier VARCHAR(200),
    passengerDetails_interactiveDetail_redressNo VARCHAR(200),
    passengerDetails_interactiveDetail_knownTravellerNo VARCHAR(200),
    passengerDetails_DocumentDetails_documentType VARCHAR(200),
    passengerDetails_DocumentDetails_documentNo VARCHAR(200),
    passengerDetails_DocumentDetails_docIssueDate VARCHAR(200),
    passengerDetails_DocumentDetails_docExpirationDate VARCHAR(200),
    passengerDetails_DocumentDetails_countryOfIssue VARCHAR(200),
    passengerDetails_DocumentDetails_cityOfIssue VARCHAR(200),
    sendingPartyDetails_contactId VARCHAR(200),
    sendingPartyDetails_contactName VARCHAR(200),
    sendingPartyDetails_firstCommsAddressCode VARCHAR(100),
    sendingPartyDetails_firstCommsAddressId VARCHAR(100),
    sendingPartyDetails_secondCommsAddressCode VARCHAR(100),
    sendingPartyDetails_secondCommsAddressId VARCHAR(200),
    dcsDetails_flightSummary_airlineCode VARCHAR(100),
    dcsDetails_flightSummary_flightArrivalAirport VARCHAR(100),
    dcsDetails_flightSummary_flightArrivalDate VARCHAR(100),
    dcsDetails_flightSummary_flightArrivalTime VARCHAR(100),
    dcsDetails_flightSummary_flightCode VARCHAR(100),
    dcsDetails_flightSummary_flightDepartureAirport VARCHAR(100),
    dcsDetails_flightSummary_flightDepartureDate VARCHAR(100),
    dcsDetails_flightSummary_flightDepartureTime VARCHAR(100),
    dcsDetails_flightSummary_rawFlightCode VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_baggageDetail VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_cabinClass VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_carryOnCount VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_checkedInCount VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_checkedInWeight VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_checkinAgent VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_checkinDateTime VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_checkinLocation VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_destination VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_firstname VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_frequentFlyerNumber VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_passengerSeq VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_pnrLocator VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_pooledTo VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_seatNumber VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_securityNumber VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_sequenceNumber VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_surname VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_ticketNumber VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_ticketStatus VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_travelDocNumber VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_travelDocType VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_travelDocLocOfIssue VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_dateOfBirth VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_gender VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_docIssueDate VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_docExpirationDate VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_cityOfIssue VARCHAR(100),
    dcsDetails_dcsData_dcsRecord_travelDocument_pnrPassengerRef VARCHAR(100),
    pnrDetails_accompaniedByInfant VARCHAR(100),
    pnrDetails_bookingDate VARCHAR(100),
    pnrDetails_creationDate VARCHAR(100),
    pnrDetails_masterPNRLocator VARCHAR(100),
    pnrDetails_modifiedDate VARCHAR(100),
    pnrDetails_pnrLocator VARCHAR(100),
    pnrDetails_retrievedDate VARCHAR(100),
    pnrDetails_splitPNR VARCHAR(100),
    pnrDetails_travelAgent VARCHAR(100),
    pnrDetails_unaccompaniedMinor VARCHAR(100),
    SourceData_Component VARCHAR(100),
    SourceData_interactiveData_commonAccessRef VARCHAR(200),
    SourceData_interactiveData_functionalGroupRefNo VARCHAR(200),
    SourceData_interactiveData_isInteractive VARCHAR(200),
    SourceData_interactiveData_route VARCHAR(200),
    SourceData_interactiveData_senderId VARCHAR(200),
    SourceData_interactiveData_variant VARCHAR(200),
    SourceData_Source VARCHAR(200),
    SourceData_Subject VARCHAR(500),
    SourceData_Type VARCHAR(200),    
    ManifestDetails_datetimeReceived VARCHAR(100),
    ManifestDetails_manifestGUID VARCHAR(100),
    ManifestDetails_dataType VARCHAR(100),
    ManifestDetails_protocol VARCHAR(100),
    cf_document_country_of_issue_not_blank_score INTEGER,
    cf_Document_expiration_not_blank_score INTEGER,
    cf_document_number_not_blank_score INTEGER,
    cf_document_type_not_blank_score INTEGER,
    cf_person_dob_not_blank_score INTEGER,
    cf_person_first_name_not_blank_score INTEGER,
    cf_person_gender_not_blank_score INTEGER,
    cf_person_last_name_not_blank_score INTEGER,
    cf_person_nationality_not_blank_score INTEGER,
    cf_person_passenger_type_not_blank_score INTEGER,
    cf_person_second_name_not_blank_score INTEGER,
    df_document_expiration_in_future_score INTEGER,
    df_document_issuing_country_refdata_match_score INTEGER,
    df_document_number_length_score INTEGER,
    df_document_type_refdata_match_score INTEGER,
    df_person_dob_not_default_score INTEGER,
    df_person_dob_in_past_score INTEGER,
    df_person_first_name_length_score INTEGER,
    df_person_first_name_not_FNU_score INTEGER,
    df_person_first_name_not_title_score INTEGER,
    df_person_gender_refdata_match_score INTEGER,
    df_person_last_name_length_score INTEGER,
    df_person_nationality_refdata_match_score INTEGER,
    df_person_passenger_pax_type_refdat_match_score INTEGER,
    vf_document_expiration_is_date_score INTEGER,
    vf_document_issuing_country_length_score INTEGER,
    vf_document_issuing_country_char_score INTEGER,
    vf_document_number_length_score INTEGER,
    vf_document_number_alphanumeric_score INTEGER,
    vf_person_dob_is_date_score INTEGER,
    vf_first_name_length_score INTEGER,
    vf_first_name_alpha_score INTEGER,
    vf_person_gender_length_score INTEGER,
    vf_person_gender_char_score INTEGER,
    vf_last_name_length_score INTEGER,
    vf_last_name_alpha_score INTEGER,
    vf_person_nationality_length_score INTEGER,
    vf_person_nationality_char_score INTEGER,
    vf_person_passenger_pax_type_length_score INTEGER,
    vf_person_passenger_pax_type_char_score INTEGER,
    vf_second_name_length_score INTEGER,
    vf_second_name_alpha_score INTEGER,
    tp_passenger_check_in_std_score INTEGER,
    tp_crew_check_in_std_score INTEGER,
    tp_passenger_departure_std_score INTEGER,
    tp_crew_departure_std_score INTEGER,
    tp_passenger_check_in_atd_score INTEGER,
    tp_crew_check_in_atd_score INTEGER,
    tp_passenger_departure_atd_score INTEGER,
    tp_crew_departure_atd_score INTEGER,
    tp_passenger_check_in_std_delta INTEGER,
    tp_crew_check_in_std_delta INTEGER,
    tp_passenger_departure_std_delta INTEGER,
    tp_crew_departure_std_delta INTEGER,
    tp_passenger_check_in_atd_delta INTEGER,
    tp_crew_check_in_atd_delta INTEGER,
    tp_passenger_departure_atd_delta INTEGER,
    tp_crew_departure_atd_delta INTEGER,
    voyageid VARCHAR(64),
    std TIMESTAMP,
    etd VARCHAR(64),
    atd VARCHAR(64),
    sta TIMESTAMP,
    eta VARCHAR(64),
    ata VARCHAR(64),
    flight_type VARCHAR(100),
    pax_flight INTEGER,
    atd_datetime_utc VARCHAR(64),
    atd_datetime_local VARCHAR(64),
    std_datetime_utc TIMESTAMP,
    std_datetime_local TIMESTAMP,
    person_iden_id VARCHAR(200),
    person_doc_id VARCHAR(400),
    person_id VARCHAR(1000),
    carrier_md_code VARCHAR(100),
    carrier_type VARCHAR(100),
    dep_port_md_code VARCHAR(100),
    dep_port_country_md_code VARCHAR(100),
    arr_port_md_code VARCHAR(100),
    arr_port_country_md_code VARCHAR(100),
    voyage_number VARCHAR(100),
    voyage_number_trailing CHAR(1),
    api_std_datetime_utc TIMESTAMP,
    api_sta_datetime_utc TIMESTAMP,
    person_md_code VARCHAR(100),
    doc_type_md_code VARCHAR(100),
    gender_md_code VARCHAR(100),
    nationality_md_code VARCHAR(250),
    hub_parsed_message_sqn VARCHAR(100),
    hub_raw_message_sqn VARCHAR(100),
    hub_voyage_clean_sqn VARCHAR(100),
    hub_voyage_raw_sqn VARCHAR(100),
    hub_person_on_a_voyage_sqn VARCHAR(100),
    id VARCHAR(100),
    s3_location VARCHAR(1000),
    xml_file_name VARCHAR(250),
    file_name VARCHAR(250),
    df_person_second_name_length_score INTEGER,
    vf_document_type_length_score INTEGER,
    vf_document_type_char_score INTEGER
)
PARTITIONED BY (path_name STRING)
STORED AS PARQUET
LOCATION '{bucket-name}/exclude/{path-name}/';
